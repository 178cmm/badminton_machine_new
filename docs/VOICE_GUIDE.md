# 語音控制整合指南

本指南整合語音連線控制、TTS 版語音控制與 UI 改進內容，作為語音相關的單一入口文件。

## 1. 功能概述
- 語音連線控制：掃描/連接/斷開、停止訓練
- 語音訓練控制：開始/停止、速度/模式切換、球路選擇
- 語音回覆：TTS 合成回覆、可選語音、語速調整

## 2. 主要文件
- 控制程式：`voice_control.py`（相容）與 `voice_control_tts.py`
- GUI：`gui/ui_voice.py`
- 規則：`rules/badminton_rules.yaml`

## 3. 常用語音指令
- 連線：掃描發球機、連接、斷開
- 訓練：開始訓練、停止訓練、快速發球、前場練習、殺球練習
- 其他：提高/降低、左/右/中間

## 4. 啟用步驟（TTS 版本）
```bash
pip install -r requirements.txt
export OPENAI_API_KEY="your-api-key"
python main.py
```
在 GUI 的語音控制頁設定 API Key、裝置與語音參數，點擊「啟動語音控制」。

## 5. 架構流程
1) 音訊捕獲 → 2) 語音識別（Whisper API） → 3) 規則匹配（YAML） → 4) 執行動作 → 5) TTS 回覆

## 6. 故障排除要點
- 閃退/記憶體：使用簡化版或安全模式；檢查音訊權限
- API Key：確認已設置且有效
- 音訊裝置：嘗試其他裝置或重啟應用
- 規則不匹配：檢查 YAML 與實際識別文字

## 7. 進階設定
- 語音選擇與語速：在 GUI 中調整
- 自訂指令：編輯 `rules/badminton_rules.yaml` 新增規則

## 8. UI 重點
- 狀態指示：運行中/等待/ASR/LLM/TTS 等狀態
- 對話記錄：您說/AI 回覆/系統/錯誤分類與時間戳

## 9. 範例流程
```
用戶：啟動語音發球機
系統：開始掃描發球機...
用戶：連接
系統：開始連接發球機...
用戶：正手高遠球 5 顆
系統：已開始發球
用戶：停止
系統：訓練已停止
```

---
維護者：開發團隊
